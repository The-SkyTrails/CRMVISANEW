{% extends "crm/base/base.html" %}
{% load static %}

{% block main-content %}


<div class="page-content">
    <div class="container-fluid">
        <div class="profile-foreground position-relative mx-n4 mt-n4">
            <div class="profile-wid-bg bg-transparent border-top">
                <!-- <img src="assets/images/profile-bg.jpg" alt="" class="profile-wid-img" /> -->
            </div>
        </div>
        <div class="pt-4 mb-4 mb-lg-3 pb-lg-4 profile-wrapper">
            <div class="row g-4">
                <div class="col-auto">
                    <div class="avatar-lg">
                        <img src="{% static "assets/images/users/avatar-1.jpg" %}" alt="user-img" class="img-thumbnail rounded-circle">
                    </div>
                </div>
                <!--end col-->
                <div class="col">
                    <div class="p-2">
                        
                        <h3 class="mb-1">{{agent.users}}</h3>
                        <p class="text-muted">{{agent.registeron}}</p>
                        <div class="hstack text-muted gap-1">
                            <div class="me-2"><i class=" ri-phone-line me-1 fs-16 align-bottom text-body"></i>{{agent.contact_no}}</div>
                            <div>
                                <i class="ri-mail-line me-1 fs-16 align-bottom text-body"></i>{{agent.users.email}}
                            </div>
                        </div>
                    </div>
                </div>
                <!--end col-->
               
                <!--end col-->

            </div>
            <!--end row-->
        </div>

        <div class="row">
            <div class="col-lg-12">
                <div>
                    <div class="d-flex profile-wrapper">
                        <!-- Nav tabs -->
                        <ul class="nav nav-pills animation-nav profile-nav gap-2 gap-lg-3 flex-grow-1" role="tablist">
                            <li class="nav-item">
                                <a class="nav-link fs-14 active" data-bs-toggle="tab" href="#alldetails-tab" role="tab">
                                    <i class="ri-airplay-fill d-inline-block d-md-none"></i> <span class="d-none d-md-inline-block">All Details</span>
                                </a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link fs-14" data-bs-toggle="tab" href="#agreement" role="tab">
                                    <i class="ri-list-unordered d-inline-block d-md-none"></i> <span class="d-none d-md-inline-block">Agreements</span>
                                </a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link fs-14" data-bs-toggle="tab" href="#kyc" role="tab">
                                    <i class="ri-price-tag-line d-inline-block d-md-none"></i> <span class="d-none d-md-inline-block">KYC Details</span>
                                </a>
                            </li>
                           
                        </ul>
                        
                    </div>
                    <!-- Tab panes -->
                    <div class="tab-content pt-4 text-muted">
                        
                        <div class="tab-pane active" id="alldetails-tab" role="tabpanel" hx-get="{% url "agent_personal_details" agent.id   %}" hx-trigger="load, movieListChanged from:body" hx-target="this" id="search-results">
                             <!-- start page title -->
                            
                    <!-- end page title -->     
                     Loading.....
                            


                           
                    </div>

                    <div class="tab-pane fade" id="agreement" role="tabpanel" hx-get="{% url "agent_agreement" agent.id   %}" hx-trigger="load, movieListChanged from:body" hx-target="this" id="search-results2">
                       
                        <!--end card-->
                    </div>
                        <!--end tab-pane-->
                        <div class="tab-pane fade" id="kyc" role="tabpanel" hx-get="{% url "agent_kyc" agent.id   %}" hx-trigger="load, movieListChanged from:body" hx-target="this" id="search-results2">
                            
                            <!--end card-->
                        </div>
                        <!--end tab-pane-->
                       
                        <!--end tab-pane-->
                    </div>
                    <!--end tab-content-->
                </div>
            </div>
            <!--end col-->
        </div>
        <!--end row-->

    </div><!-- container-fluid -->
</div><!-- End Page-content -->




<script>
    document.addEventListener('DOMContentLoaded', function() {
        
        // Get the last active tab from localStorage
        const activeTab = localStorage.getItem('activeTab');
        
        
        if (activeTab) {
            // Use Bootstrap's tab method to show the stored active tab
            const tabElement = document.querySelector(`[href="${activeTab}"]`);
            if (tabElement) {
                const tabInstance = new bootstrap.Tab(tabElement);
                tabInstance.show();
            }
        } else {
            // Default to showing the first tab if no active tab is stored
            const firstTabElement = document.querySelector('.nav-link');
            if (firstTabElement) {
                const firstTabInstance = new bootstrap.Tab(firstTabElement);
                firstTabInstance.show();
            }
        }

        // Save the clicked tab in localStorage
        document.querySelectorAll('.nav-link').forEach(tab => {
            tab.addEventListener('click', function() {
                localStorage.setItem('activeTab', this.getAttribute('href'));
            });
        });
    });

    function myfunc(){
        
        document.getElementById("message-text").value  = ""
        
        
    }
</script>
{% endblock main-content %}